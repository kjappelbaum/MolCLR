nohup: ignoring input
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'opv_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.5446265938069217, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/opv/opv.csv', 'regression_bin_classes': 2}}
Running on: cpu
1097
No validation set, using training set for validation
Train size: 499, Valid size: 499, Test size: 598
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.7253965139389038
Validation loss: 0.8608198594712542 ROC AUC: 0.5643935742971888
Validation loss: 0.7228337150059625 ROC AUC: 0.6371485943775099
Validation loss: 0.6724822598851038 ROC AUC: 0.6460481927710844
3 2 0.7517529726028442
Validation loss: 0.6928595895757657 ROC AUC: 0.6537349397590362
Validation loss: 0.7483697434465488 ROC AUC: 0.6649236947791165
Validation loss: 0.6447682744993236 ROC AUC: 0.6728995983935743
6 4 0.589646577835083
Validation loss: 0.6287556736168259 ROC AUC: 0.6996626506024097
Validation loss: 0.6373775825949614 ROC AUC: 0.708714859437751
Validation loss: 0.6870721424509862 ROC AUC: 0.7226425702811246
9 6 0.6078175902366638
Validation loss: 0.7884383337770053 ROC AUC: 0.7280481927710843
Validation loss: 0.5979972332417368 ROC AUC: 0.765558232931727
Validation loss: 0.5832446551991847 ROC AUC: 0.7743775100401606
12 8 0.6804107427597046
Validation loss: 0.6998641278318508 ROC AUC: 0.7897670682730925
Validation loss: 0.6305669481625299 ROC AUC: 0.7885622489959838
Validation loss: 0.8309225484221159 ROC AUC: 0.7931164658634539
15 10 0.691869854927063
Validation loss: 0.5825630877921003 ROC AUC: 0.7897991967871485
Validation loss: 0.5769374451799718 ROC AUC: 0.8049156626506023
Validation loss: 0.5469920822757041 ROC AUC: 0.8097670682730924
18 12 0.7381837368011475
Validation loss: 0.5486026495874287 ROC AUC: 0.811437751004016
Validation loss: 0.6031942441611586 ROC AUC: 0.8131485943775101
Validation loss: 0.5163682668744204 ROC AUC: 0.8241847389558232
21 14 0.5759174823760986
Validation loss: 0.8833860611628913 ROC AUC: 0.8189156626506024
Validation loss: 0.7186378512927191 ROC AUC: 0.8192851405622491
Validation loss: 0.7037102804633085 ROC AUC: 0.8247710843373494
Validation loss: 0.5792418353423805 ROC AUC: 0.8367710843373495
25 0 0.47074443101882935
Validation loss: 0.5412340184490761 ROC AUC: 0.8304658634538153
Validation loss: 0.5154931127188918 ROC AUC: 0.8310763052208836
Validation loss: 0.7555406939290569 ROC AUC: 0.8332851405622491
28 2 0.48281288146972656
Validation loss: 0.5158828677299744 ROC AUC: 0.8377028112449799
Validation loss: 0.6584253664723857 ROC AUC: 0.8344738955823293
Validation loss: 0.5967485824663319 ROC AUC: 0.8333172690763052
31 4 0.47875335812568665
Validation loss: 0.5051109295689271 ROC AUC: 0.8399116465863454
Validation loss: 0.6377351739124688 ROC AUC: 0.8452690763052207
Validation loss: 0.710497700857495 ROC AUC: 0.8503694779116465
34 6 0.5712916254997253
Validation loss: 0.5601257705736256 ROC AUC: 0.8446345381526106
Validation loss: 0.5179285460818029 ROC AUC: 0.8431164658634538
Validation loss: 0.5917765801559708 ROC AUC: 0.8503373493975904
37 8 0.5202921628952026
Validation loss: 0.556018486171065 ROC AUC: 0.850289156626506
Validation loss: 0.6193677151131487 ROC AUC: 0.8464819277108434
Validation loss: 0.5747212243223477 ROC AUC: 0.847421686746988
40 10 0.48827868700027466
Validation loss: 0.5689043458812462 ROC AUC: 0.8540883534136546
Validation loss: 0.5481566595648955 ROC AUC: 0.8543453815261043
Validation loss: 0.5215184160009892 ROC AUC: 0.8515502008032129
43 12 0.488259881734848
Validation loss: 0.5814818068592247 ROC AUC: 0.8586425702811246
Validation loss: 0.4787460884493673 ROC AUC: 0.861839357429719
Validation loss: 0.5765584498823048 ROC AUC: 0.8616867469879518
46 14 0.6317671537399292
Validation loss: 0.5057148443673082 ROC AUC: 0.8612369477911647
Validation loss: 0.5752065509617448 ROC AUC: 0.8601526104417669
Validation loss: 0.4952410816668509 ROC AUC: 0.8613012048192771
Validation loss: 0.581072936614673 ROC AUC: 0.8571646586345382
50 0 0.380666047334671
Validation loss: 0.4631029445685461 ROC AUC: 0.863871485943775
Validation loss: 0.4483128703667788 ROC AUC: 0.8670682730923696
Validation loss: 0.5021959479920611 ROC AUC: 0.8711405622489959
53 2 0.516045331954956
Validation loss: 0.4567442390627278 ROC AUC: 0.869983935742972
Validation loss: 0.47697433082756396 ROC AUC: 0.8647068273092369
Validation loss: 0.44886044163503247 ROC AUC: 0.873421686746988
56 4 0.48423466086387634
Validation loss: 0.4655696377008855 ROC AUC: 0.8727389558232932
Validation loss: 0.47818489059178765 ROC AUC: 0.8715261044176708
Validation loss: 0.4710321234080022 ROC AUC: 0.8701124497991969
59 6 0.41281649470329285
Validation loss: 0.4623769887821947 ROC AUC: 0.869718875502008
Validation loss: 0.47736718181617754 ROC AUC: 0.8723614457831325
Validation loss: 0.4550713886598308 ROC AUC: 0.8727630522088354
62 8 0.48755815625190735
Validation loss: 0.4398612627285516 ROC AUC: 0.8779678714859438
Validation loss: 0.5206840135649832 ROC AUC: 0.8714698795180723
Validation loss: 0.4620244416421305 ROC AUC: 0.8768594377510041
65 10 0.5753586292266846
Validation loss: 0.5103816908442663 ROC AUC: 0.8748674698795181
Validation loss: 0.4756016719914629 ROC AUC: 0.8807309236947791
Validation loss: 0.4315706415023498 ROC AUC: 0.8828032128514056
68 12 0.5582207441329956
Validation loss: 0.5095370859803561 ROC AUC: 0.874570281124498
Validation loss: 0.47025908616358386 ROC AUC: 0.8710361445783132
Validation loss: 0.4836386432628593 ROC AUC: 0.8831887550200803
71 14 0.4648476541042328
Validation loss: 0.4883188518111357 ROC AUC: 0.8818232931726908
Validation loss: 0.41997318196750594 ROC AUC: 0.8854779116465864
Validation loss: 0.45070554868491713 ROC AUC: 0.8782650602409638
Validation loss: 0.46979261286750823 ROC AUC: 0.8837831325301204
75 0 0.4796786606311798
Validation loss: 0.45496411833591116 ROC AUC: 0.8848674698795181
Validation loss: 0.45400197562091577 ROC AUC: 0.8809799196787148
Validation loss: 0.49143277237076083 ROC AUC: 0.8844658634538153
78 2 0.39145833253860474
Validation loss: 0.47876391334380797 ROC AUC: 0.884570281124498
Validation loss: 0.43323769986271143 ROC AUC: 0.8780642570281124
Validation loss: 0.4358525819076087 ROC AUC: 0.890867469879518
81 4 0.43798795342445374
Validation loss: 0.4401866509943066 ROC AUC: 0.8875582329317269
Validation loss: 0.45338290810346127 ROC AUC: 0.8860080321285141
Validation loss: 0.47604902091628326 ROC AUC: 0.8835421686746989
84 6 0.6351370811462402
Validation loss: 0.4673791452495751 ROC AUC: 0.8927309236947791
Validation loss: 0.47907709484109895 ROC AUC: 0.8963694779116466
Validation loss: 0.453087613195599 ROC AUC: 0.8919116465863455
87 8 0.5095616579055786
Validation loss: 0.41950614275578746 ROC AUC: 0.8896546184738956
Validation loss: 0.43543239502247444 ROC AUC: 0.8950522088353413
Validation loss: 0.4284779889311246 ROC AUC: 0.8960562248995984
90 10 0.48720207810401917
Validation loss: 0.4262668302876199 ROC AUC: 0.8969076305220883
Validation loss: 0.4645077364896247 ROC AUC: 0.8888192771084338
Validation loss: 0.4172918609602896 ROC AUC: 0.895285140562249
93 12 0.5779386758804321
Validation loss: 0.4492940375943461 ROC AUC: 0.8958313253012049
Validation loss: 0.4351138311302017 ROC AUC: 0.8964658634538153
Validation loss: 0.47623363525451784 ROC AUC: 0.8943935742971887
96 14 0.4097633361816406
Validation loss: 0.4784836174252038 ROC AUC: 0.8839357429718876
Validation loss: 0.5026824369220313 ROC AUC: 0.8897831325301204
Validation loss: 0.4789910723785599 ROC AUC: 0.8917349397590362
Validation loss: 0.4674129810385809 ROC AUC: 0.893991967871486
Loaded trained model with success.
2023-02-12 16:34:36.458 | ERROR    | __main__:<module>:183 - With n_samples=5000, test_size=0.9999848297979177 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
Traceback (most recent call last):

> File "finetune_lc.py", line 181, in <module>
    run_expt(task, train_points)
    │        │     └ 10
    │        └ 'qmug_2'
    └ <function run_expt at 0x7fcc27759560>

  File "finetune_lc.py", line 166, in run_expt
    result = main(config)
             │    └ {'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp1...
             └ <function main at 0x7fcc34c5c4d0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 361, in main
    fine_tune.train()
    │         └ <function FineTune.train at 0x7fcc277495f0>
    └ <finetune.FineTune object at 0x7fcc27b70bd0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 108, in train
    train_loader, valid_loader, test_loader = self.dataset.get_data_loaders()
                                              │    │       └ <function MolTestDatasetWrapper.get_data_loaders at 0x7fcc278aa5f0>
                                              │    └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27b70d90>
                                              └ <finetune.FineTune object at 0x7fcc27b70bd0>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 195, in get_data_loaders
    train_loader, valid_loader, test_loader = self.get_train_validation_data_loaders(train_dataset)
                                              │    │                                 └ MolTestDataset(5000)
                                              │    └ <function MolTestDatasetWrapper.get_train_validation_data_loaders at 0x7fcc278aa680>
                                              └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27b70d90>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 219, in get_train_validation_data_loaders
    train_idx, test_idx, stratify_train, stratify_test = train_test_split(indices, ys, test_size=1 - train_ratio, stratify=ys)
                                                         │                │        │                 │                     └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                │        │                 └ 1.517020208230413e-05
                                                         │                │        └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                └ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33...
                                                         └ <function train_test_split at 0x7fcc577a08c0>

  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2421, in train_test_split
    n_samples, test_size, train_size, default_test_size=0.25
    │          │          └ None
    │          └ 0.9999848297979177
    └ 5000
  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2101, in _validate_shuffle_split
    "aforementioned parameters.".format(n_samples, test_size, train_size)
                                        │          │          └ None
                                        │          └ 0.9999848297979177
                                        └ 5000

ValueError: With n_samples=5000, test_size=0.9999848297979177 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
2023-02-12 16:36:50.763 | ERROR    | __main__:<module>:183 - With n_samples=5000, test_size=0.9999241489895887 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
Traceback (most recent call last):

> File "finetune_lc.py", line 181, in <module>
    run_expt(task, train_points)
    │        │     └ 50
    │        └ 'qmug_2'
    └ <function run_expt at 0x7fcc27759560>

  File "finetune_lc.py", line 166, in run_expt
    result = main(config)
             │    └ {'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp1...
             └ <function main at 0x7fcc34c5c4d0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 361, in main
    fine_tune.train()
    │         └ <function FineTune.train at 0x7fcc277495f0>
    └ <finetune.FineTune object at 0x7fcc3432a250>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 108, in train
    train_loader, valid_loader, test_loader = self.dataset.get_data_loaders()
                                              │    │       └ <function MolTestDatasetWrapper.get_data_loaders at 0x7fcc278aa5f0>
                                              │    └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27ee7650>
                                              └ <finetune.FineTune object at 0x7fcc3432a250>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 195, in get_data_loaders
    train_loader, valid_loader, test_loader = self.get_train_validation_data_loaders(train_dataset)
                                              │    │                                 └ MolTestDataset(5000)
                                              │    └ <function MolTestDatasetWrapper.get_train_validation_data_loaders at 0x7fcc278aa680>
                                              └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27ee7650>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 219, in get_train_validation_data_loaders
    train_idx, test_idx, stratify_train, stratify_test = train_test_split(indices, ys, test_size=1 - train_ratio, stratify=ys)
                                                         │                │        │                 │                     └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                │        │                 └ 7.58510104112986e-05
                                                         │                │        └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                └ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33...
                                                         └ <function train_test_split at 0x7fcc577a08c0>

  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2421, in train_test_split
    n_samples, test_size, train_size, default_test_size=0.25
    │          │          └ None
    │          └ 0.9999241489895887
    └ 5000
  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2101, in _validate_shuffle_split
    "aforementioned parameters.".format(n_samples, test_size, train_size)
                                        │          │          └ None
                                        │          └ 0.9999241489895887
                                        └ 5000

ValueError: With n_samples=5000, test_size=0.9999241489895887 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
2023-02-12 16:39:05.494 | ERROR    | __main__:<module>:183 - With n_samples=5000, test_size=0.9998482979791774 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
Traceback (most recent call last):

> File "finetune_lc.py", line 181, in <module>
    run_expt(task, train_points)
    │        │     └ 100
    │        └ 'qmug_2'
    └ <function run_expt at 0x7fcc27759560>

  File "finetune_lc.py", line 166, in run_expt
    result = main(config)
             │    └ {'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp1...
             └ <function main at 0x7fcc34c5c4d0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 361, in main
    fine_tune.train()
    │         └ <function FineTune.train at 0x7fcc277495f0>
    └ <finetune.FineTune object at 0x7fcc276ac450>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 108, in train
    train_loader, valid_loader, test_loader = self.dataset.get_data_loaders()
                                              │    │       └ <function MolTestDatasetWrapper.get_data_loaders at 0x7fcc278aa5f0>
                                              │    └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc276ac4d0>
                                              └ <finetune.FineTune object at 0x7fcc276ac450>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 195, in get_data_loaders
    train_loader, valid_loader, test_loader = self.get_train_validation_data_loaders(train_dataset)
                                              │    │                                 └ MolTestDataset(5000)
                                              │    └ <function MolTestDatasetWrapper.get_train_validation_data_loaders at 0x7fcc278aa680>
                                              └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc276ac4d0>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 219, in get_train_validation_data_loaders
    train_idx, test_idx, stratify_train, stratify_test = train_test_split(indices, ys, test_size=1 - train_ratio, stratify=ys)
                                                         │                │        │                 │                     └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                │        │                 └ 0.0001517020208225972
                                                         │                │        └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                └ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33...
                                                         └ <function train_test_split at 0x7fcc577a08c0>

  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2421, in train_test_split
    n_samples, test_size, train_size, default_test_size=0.25
    │          │          └ None
    │          └ 0.9998482979791774
    └ 5000
  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2101, in _validate_shuffle_split
    "aforementioned parameters.".format(n_samples, test_size, train_size)
                                        │          │          └ None
                                        │          └ 0.9998482979791774
                                        └ 5000

ValueError: With n_samples=5000, test_size=0.9998482979791774 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
2023-02-12 16:41:20.204 | ERROR    | __main__:<module>:183 - The train_size = 1 should be greater or equal to the number of classes = 2
Traceback (most recent call last):

> File "finetune_lc.py", line 181, in <module>
    run_expt(task, train_points)
    │        │     └ 200
    │        └ 'qmug_2'
    └ <function run_expt at 0x7fcc27759560>

  File "finetune_lc.py", line 166, in run_expt
    result = main(config)
             │    └ {'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp1...
             └ <function main at 0x7fcc34c5c4d0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 361, in main
    fine_tune.train()
    │         └ <function FineTune.train at 0x7fcc277495f0>
    └ <finetune.FineTune object at 0x7fcc275709d0>

  File "/home/kjablonka/git/MolCLR/finetune.py", line 108, in train
    train_loader, valid_loader, test_loader = self.dataset.get_data_loaders()
                                              │    │       └ <function MolTestDatasetWrapper.get_data_loaders at 0x7fcc278aa5f0>
                                              │    └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27570090>
                                              └ <finetune.FineTune object at 0x7fcc275709d0>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 195, in get_data_loaders
    train_loader, valid_loader, test_loader = self.get_train_validation_data_loaders(train_dataset)
                                              │    │                                 └ MolTestDataset(5000)
                                              │    └ <function MolTestDatasetWrapper.get_train_validation_data_loaders at 0x7fcc278aa680>
                                              └ <dataset.dataset_test.MolTestDatasetWrapper object at 0x7fcc27570090>

  File "/home/kjablonka/git/MolCLR/dataset/dataset_test.py", line 219, in get_train_validation_data_loaders
    train_idx, test_idx, stratify_train, stratify_test = train_test_split(indices, ys, test_size=1 - train_ratio, stratify=ys)
                                                         │                │        │                 │                     └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                │        │                 └ 0.0003034040416451944
                                                         │                │        └ array([1, 0, 1, ..., 0, 0, 0])
                                                         │                └ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33...
                                                         └ <function train_test_split at 0x7fcc577a08c0>

  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 2441, in train_test_split
    train, test = next(cv.split(X=arrays[0], y=stratify))
                       │  │       │            └ array([1, 0, 1, ..., 0, 0, 0])
                       │  │       └ [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 3...
                       │  └ <function StratifiedShuffleSplit.split at 0x7fcc577a03b0>
                       └ StratifiedShuffleSplit(n_splits=10, random_state=None, test_size=4999,
                                     train_size=1)
  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 1600, in split
    for train, test in self._iter_indices(X, y, groups):
                       │    │             │  │  └ None
                       │    │             │  └ array([1, 0, 1, ..., 0, 0, 0])
                       │    │             └ [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33...
                       │    └ <function StratifiedShuffleSplit._iter_indices at 0x7fcc577a0320>
                       └ StratifiedShuffleSplit(n_splits=10, random_state=None, test_size=4999,
                                     train_size=1)
  File "/home/kjablonka/miniconda3/envs/molclr/lib/python3.7/site-packages/sklearn/model_selection/_split.py", line 1950, in _iter_indices
    "equal to the number of classes = %d" % (n_train, n_classes)
                                             │        └ 2
                                             └ 1

ValueError: The train_size = 1 should be greater or equal to the number of classes = 2
Test loss: 0.7541212296007469 Test ROC AUC: 0.7022796165590989
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9999848297979177, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9999241489895887, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9998482979791774, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9996965959583548, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9992414898958869, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
No validation set, using training set for validation
Train size: 3, Valid size: 3, Test size: 4997
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.9989404678344727
Validation loss: 0.7195985913276672 ROC AUC: 1.0
Validation loss: 0.6361216902732849 ROC AUC: 1.0
Validation loss: 0.6840334534645081 ROC AUC: 1.0
Validation loss: 0.7660407423973083 ROC AUC: 0.5
Validation loss: 0.8516594767570496 ROC AUC: 0.5
Validation loss: 0.9211956858634949 ROC AUC: 0.5
Validation loss: 0.9759792685508728 ROC AUC: 0.5
Validation loss: 1.0036441087722778 ROC AUC: 1.0
Validation loss: 1.0016701221466064 ROC AUC: 1.0
Validation loss: 1.0059736967086792 ROC AUC: 1.0
Validation loss: 0.9564168453216553 ROC AUC: 1.0
Validation loss: 0.913240909576416 ROC AUC: 1.0
Validation loss: 0.870532214641571 ROC AUC: 1.0
Validation loss: 0.8496191501617432 ROC AUC: 1.0
Validation loss: 0.8469685912132263 ROC AUC: 1.0
Validation loss: 0.8088608384132385 ROC AUC: 1.0
Validation loss: 0.7294169068336487 ROC AUC: 1.0
Validation loss: 0.6146780848503113 ROC AUC: 1.0
Validation loss: 0.5174280405044556 ROC AUC: 1.0
Validation loss: 0.4748270511627197 ROC AUC: 1.0
Validation loss: 0.3546513020992279 ROC AUC: 1.0
Validation loss: 0.22403134405612946 ROC AUC: 1.0
Validation loss: 0.15343256294727325 ROC AUC: 1.0
Validation loss: 0.11711239814758301 ROC AUC: 1.0
Validation loss: 0.09497016668319702 ROC AUC: 1.0
Validation loss: 0.06443282216787338 ROC AUC: 1.0
Validation loss: 0.04785320162773132 ROC AUC: 1.0
Validation loss: 0.033783432096242905 ROC AUC: 1.0
Validation loss: 0.023010971024632454 ROC AUC: 1.0
Validation loss: 0.01828601211309433 ROC AUC: 1.0
Validation loss: 0.013660433702170849 ROC AUC: 1.0
Validation loss: 0.01093959528952837 ROC AUC: 1.0
Validation loss: 0.009321232326328754 ROC AUC: 1.0
Validation loss: 0.009756297804415226 ROC AUC: 1.0
Validation loss: 0.009881735779345036 ROC AUC: 1.0
Validation loss: 0.008250868879258633 ROC AUC: 1.0
Validation loss: 0.006527464836835861 ROC AUC: 1.0
Validation loss: 0.005689664278179407 ROC AUC: 1.0
Validation loss: 0.003925500437617302 ROC AUC: 1.0
Validation loss: 0.004095861688256264 ROC AUC: 1.0
Validation loss: 0.0058385455049574375 ROC AUC: 1.0
Validation loss: 0.008176115341484547 ROC AUC: 1.0
Validation loss: 0.008389413356781006 ROC AUC: 1.0
Validation loss: 0.00791300367563963 ROC AUC: 1.0
Validation loss: 0.009585286490619183 ROC AUC: 1.0
Validation loss: 0.008996556513011456 ROC AUC: 1.0
Validation loss: 0.006814523134380579 ROC AUC: 1.0
Validation loss: 0.0064628547988832 ROC AUC: 1.0
Validation loss: 0.00469270721077919 ROC AUC: 1.0
Validation loss: 0.004222885239869356 ROC AUC: 1.0
50 0 0.0011759711196646094
Validation loss: 0.005310208071023226 ROC AUC: 1.0
Validation loss: 0.0037439411971718073 ROC AUC: 1.0
Validation loss: 0.0031924762297421694 ROC AUC: 1.0
Validation loss: 0.002054148120805621 ROC AUC: 1.0
Validation loss: 0.0020657465793192387 ROC AUC: 1.0
Validation loss: 0.0020209660287946463 ROC AUC: 1.0
Validation loss: 0.0018701418302953243 ROC AUC: 1.0
Validation loss: 0.0017851487500593066 ROC AUC: 1.0
Validation loss: 0.003330603241920471 ROC AUC: 1.0
Validation loss: 0.0018066562479361892 ROC AUC: 1.0
Validation loss: 0.001937200897373259 ROC AUC: 1.0
Validation loss: 0.001640736940316856 ROC AUC: 1.0
Validation loss: 0.001071654143743217 ROC AUC: 1.0
Validation loss: 0.0010770026128739119 ROC AUC: 1.0
Validation loss: 0.0017850962467491627 ROC AUC: 1.0
Validation loss: 0.0011354493908584118 ROC AUC: 1.0
Validation loss: 0.000987509498372674 ROC AUC: 1.0
Validation loss: 0.0007039504707790911 ROC AUC: 1.0
Validation loss: 0.0006380139966495335 ROC AUC: 1.0
Validation loss: 0.000827474519610405 ROC AUC: 1.0
Validation loss: 0.0009549660026095808 ROC AUC: 1.0
Validation loss: 0.001786031643860042 ROC AUC: 1.0
Validation loss: 0.0009880999568849802 ROC AUC: 1.0
Validation loss: 0.0007376997382380068 ROC AUC: 1.0
Validation loss: 0.0005685040960088372 ROC AUC: 1.0
Validation loss: 0.0009302730322815478 ROC AUC: 1.0
Validation loss: 0.0005291335401125252 ROC AUC: 1.0
Validation loss: 0.0005517539684660733 ROC AUC: 1.0
Validation loss: 0.0004585332644637674 ROC AUC: 1.0
Validation loss: 0.000410583452321589 ROC AUC: 1.0
Validation loss: 0.0002641215978655964 ROC AUC: 1.0
Validation loss: 0.0001846930244937539 ROC AUC: 1.0
Validation loss: 0.00011343202641000971 ROC AUC: 1.0
Validation loss: 7.986269338289276e-05 ROC AUC: 1.0
Validation loss: 8.621924644103274e-05 ROC AUC: 1.0
Validation loss: 6.599717744393274e-05 ROC AUC: 1.0
Validation loss: 0.00010934044985333458 ROC AUC: 1.0
Validation loss: 0.0001678119442658499 ROC AUC: 1.0
Validation loss: 0.00015565809735562652 ROC AUC: 1.0
Validation loss: 0.00011843730317195877 ROC AUC: 1.0
Validation loss: 0.00010659906547516584 ROC AUC: 1.0
Validation loss: 6.405026942957193e-05 ROC AUC: 1.0
Validation loss: 8.899998647393659e-05 ROC AUC: 1.0
Validation loss: 9.881239384412766e-05 ROC AUC: 1.0
Validation loss: 9.356847294839099e-05 ROC AUC: 1.0
Validation loss: 7.851148984627798e-05 ROC AUC: 1.0
Validation loss: 0.00013897327880840749 ROC AUC: 1.0
Validation loss: 0.00018004390585701913 ROC AUC: 1.0
Validation loss: 0.00014814863970968872 ROC AUC: 1.0
Validation loss: 8.681459439685568e-05 ROC AUC: 1.0
Loaded trained model with success.
Test loss: 0.7310293696750658 Test ROC AUC: 0.7584681253383271
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'qmug_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9984829797917738, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/qmug/qmug.csv', 'regression_bin_classes': 2}}
Running on: cpu
659186
No validation set, using training set for validation
Train size: 7, Valid size: 7, Test size: 4993
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.8590801954269409
Validation loss: 0.7002899050712585 ROC AUC: 0.4
Validation loss: 0.6217852830886841 ROC AUC: 0.6
Validation loss: 0.6074044108390808 ROC AUC: 0.9
Validation loss: 0.6154716610908508 ROC AUC: 1.0
Validation loss: 0.6451800465583801 ROC AUC: 1.0
Validation loss: 0.6933057904243469 ROC AUC: 1.0
Validation loss: 0.7612382769584656 ROC AUC: 0.8
Validation loss: 0.8972119688987732 ROC AUC: 0.7
Validation loss: 1.0798046588897705 ROC AUC: 0.7
Validation loss: 1.261459469795227 ROC AUC: 0.8
Validation loss: 1.3581477403640747 ROC AUC: 0.8
Validation loss: 1.4199825525283813 ROC AUC: 1.0
Validation loss: 1.4171193838119507 ROC AUC: 1.0
Validation loss: 1.4685300588607788 ROC AUC: 1.0
Validation loss: 1.5504827499389648 ROC AUC: 1.0
Validation loss: 1.4422082901000977 ROC AUC: 1.0
Validation loss: 1.2092684507369995 ROC AUC: 1.0
Validation loss: 1.099008321762085 ROC AUC: 1.0
Validation loss: 0.8288252949714661 ROC AUC: 1.0
Validation loss: 0.73175048828125 ROC AUC: 1.0
Validation loss: 0.510179877281189 ROC AUC: 1.0
Validation loss: 0.32746174931526184 ROC AUC: 1.0
Validation loss: 0.22712714970111847 ROC AUC: 1.0
Validation loss: 0.15972793102264404 ROC AUC: 1.0
Validation loss: 0.12022631615400314 ROC AUC: 1.0
Validation loss: 0.09915290772914886 ROC AUC: 1.0
Validation loss: 0.0629776120185852 ROC AUC: 1.0
Validation loss: 0.03838641569018364 ROC AUC: 1.0
Validation loss: 0.025112101808190346 ROC AUC: 1.0
Validation loss: 0.020320052281022072 ROC AUC: 1.0
Validation loss: 0.018068810924887657 ROC AUC: 1.0
Validation loss: 0.015884052962064743 ROC AUC: 1.0
Validation loss: 0.012590075843036175 ROC AUC: 1.0
Validation loss: 0.013391799293458462 ROC AUC: 1.0
Validation loss: 0.01452502142637968 ROC AUC: 1.0
Validation loss: 0.015700094401836395 ROC AUC: 1.0
Validation loss: 0.015645761042833328 ROC AUC: 1.0
Validation loss: 0.01423014234751463 ROC AUC: 1.0
Validation loss: 0.013138107024133205 ROC AUC: 1.0
Validation loss: 0.011601695790886879 ROC AUC: 1.0
Validation loss: 0.00976826436817646 ROC AUC: 1.0
Validation loss: 0.008825649507343769 ROC AUC: 1.0
Validation loss: 0.00962772686034441 ROC AUC: 1.0
Validation loss: 0.009772622026503086 ROC AUC: 1.0
Validation loss: 0.009808579459786415 ROC AUC: 1.0
Validation loss: 0.00904189981520176 ROC AUC: 1.0
Validation loss: 0.008991139009594917 ROC AUC: 1.0
Validation loss: 0.010837922804057598 ROC AUC: 1.0
Validation loss: 0.010921576991677284 ROC AUC: 1.0
Validation loss: 0.01198154129087925 ROC AUC: 1.0
50 0 0.01642601378262043
Validation loss: 0.012360021471977234 ROC AUC: 1.0
Validation loss: 0.012123318389058113 ROC AUC: 1.0
Validation loss: 0.011797422543168068 ROC AUC: 1.0
Validation loss: 0.01166852843016386 ROC AUC: 1.0
Validation loss: 0.009900972247123718 ROC AUC: 1.0
Validation loss: 0.00893044751137495 ROC AUC: 1.0
Validation loss: 0.008107731118798256 ROC AUC: 1.0
Validation loss: 0.0067643532529473305 ROC AUC: 1.0
Validation loss: 0.005806927103549242 ROC AUC: 1.0
Validation loss: 0.004549394827336073 ROC AUC: 1.0
Validation loss: 0.004183732904493809 ROC AUC: 1.0
Validation loss: 0.0036830208264291286 ROC AUC: 1.0
Validation loss: 0.0030302261002361774 ROC AUC: 1.0
Validation loss: 0.002592326607555151 ROC AUC: 1.0
Validation loss: 0.0022950347047299147 ROC AUC: 1.0
Validation loss: 0.0018662087386474013 ROC AUC: 1.0
Validation loss: 0.0016841439064592123 ROC AUC: 1.0
Validation loss: 0.0015304798725992441 ROC AUC: 1.0
Validation loss: 0.0014291253173723817 ROC AUC: 1.0
Validation loss: 0.0013347921194508672 ROC AUC: 1.0
Validation loss: 0.0012844244483858347 ROC AUC: 1.0
Validation loss: 0.0011970673222094774 ROC AUC: 1.0
Validation loss: 0.0011714812135323882 ROC AUC: 1.0
Validation loss: 0.0011688090162351727 ROC AUC: 1.0
Validation loss: 0.0011224753689020872 ROC AUC: 1.0
Validation loss: 0.0010048960102722049 ROC AUC: 1.0
Validation loss: 0.0010005120420828462 ROC AUC: 1.0
Validation loss: 0.0009746528812684119 ROC AUC: 1.0
Validation loss: 0.0009859383571892977 ROC AUC: 1.0
Validation loss: 0.0009396403911523521 ROC AUC: 1.0
Validation loss: 0.0008823013631626964 ROC AUC: 1.0
Validation loss: 0.0008453041664324701 ROC AUC: 1.0
Validation loss: 0.0008396237390115857 ROC AUC: 1.0
Validation loss: 0.0007540745427832007 ROC AUC: 1.0
Validation loss: 0.0006939080194570124 ROC AUC: 1.0
Validation loss: 0.0006753894849680364 ROC AUC: 1.0
Validation loss: 0.0006309612072072923 ROC AUC: 1.0
Validation loss: 0.0006447882042266428 ROC AUC: 1.0
Validation loss: 0.0006672260933555663 ROC AUC: 1.0
Validation loss: 0.0006941124447621405 ROC AUC: 1.0
Validation loss: 0.0007821515901014209 ROC AUC: 1.0
Validation loss: 0.0008927200688049197 ROC AUC: 1.0
Validation loss: 0.0008567730546928942 ROC AUC: 1.0
Validation loss: 0.0008305232622660697 ROC AUC: 1.0
Validation loss: 0.0008538231486454606 ROC AUC: 1.0
Validation loss: 0.0007926997495815158 ROC AUC: 1.0
Validation loss: 0.0007416075095534325 ROC AUC: 1.0
Validation loss: 0.0007447647512890399 ROC AUC: 1.0
Validation loss: 0.0007711721700616181 ROC AUC: 1.0
Validation loss: 0.0007552257156930864 ROC AUC: 1.0
Loaded trained model with success.
Test loss: 0.6044059875623606 Test ROC AUC: 0.7360749186005818
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'photoswitch_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9751861042183623, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/photoswitch/photoswitch.csv', 'regression_bin_classes': 2}}
Running on: cpu
389
No validation set, using training set for validation
Train size: 9, Valid size: 9, Test size: 380
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.7643120884895325
Validation loss: 0.706916093826294 ROC AUC: 0.45
Validation loss: 0.6997101306915283 ROC AUC: 0.45
Validation loss: 0.7177649140357971 ROC AUC: 0.6
Validation loss: 0.7032645344734192 ROC AUC: 0.6
Validation loss: 0.6866472363471985 ROC AUC: 0.55
Validation loss: 0.7087633609771729 ROC AUC: 0.45
Validation loss: 0.7514896988868713 ROC AUC: 0.5
Validation loss: 0.7956210374832153 ROC AUC: 0.85
Validation loss: 0.8353438973426819 ROC AUC: 0.8
Validation loss: 0.8532805442810059 ROC AUC: 0.85
Validation loss: 0.8737086653709412 ROC AUC: 0.8
Validation loss: 0.8780772686004639 ROC AUC: 0.8
Validation loss: 0.8101860880851746 ROC AUC: 0.9
Validation loss: 0.74720299243927 ROC AUC: 0.95
Validation loss: 0.6944032311439514 ROC AUC: 0.95
Validation loss: 0.6471220850944519 ROC AUC: 0.95
Validation loss: 0.5926074385643005 ROC AUC: 0.95
Validation loss: 0.5419937968254089 ROC AUC: 1.0
Validation loss: 0.49542224407196045 ROC AUC: 1.0
Validation loss: 0.44027942419052124 ROC AUC: 1.0
Validation loss: 0.37536418437957764 ROC AUC: 1.0
Validation loss: 0.3543362319469452 ROC AUC: 1.0
Validation loss: 0.3414604961872101 ROC AUC: 1.0
Validation loss: 0.32262706756591797 ROC AUC: 1.0
Validation loss: 0.30669742822647095 ROC AUC: 1.0
Validation loss: 0.3035428822040558 ROC AUC: 1.0
Validation loss: 0.29819825291633606 ROC AUC: 1.0
Validation loss: 0.2944042682647705 ROC AUC: 1.0
Validation loss: 0.29678767919540405 ROC AUC: 1.0
Validation loss: 0.3008984923362732 ROC AUC: 1.0
Validation loss: 0.3144127130508423 ROC AUC: 1.0
Validation loss: 0.32488954067230225 ROC AUC: 1.0
Validation loss: 0.3335515856742859 ROC AUC: 1.0
Validation loss: 0.34430038928985596 ROC AUC: 1.0
Validation loss: 0.31679317355155945 ROC AUC: 1.0
Validation loss: 0.3035096526145935 ROC AUC: 1.0
Validation loss: 0.28916773200035095 ROC AUC: 1.0
Validation loss: 0.2777225375175476 ROC AUC: 1.0
Validation loss: 0.2815484404563904 ROC AUC: 1.0
Validation loss: 0.25833064317703247 ROC AUC: 1.0
Validation loss: 0.24193912744522095 ROC AUC: 1.0
Validation loss: 0.22263720631599426 ROC AUC: 1.0
Validation loss: 0.2136436551809311 ROC AUC: 1.0
Validation loss: 0.19760173559188843 ROC AUC: 1.0
Validation loss: 0.19689074158668518 ROC AUC: 1.0
Validation loss: 0.20580992102622986 ROC AUC: 1.0
Validation loss: 0.20722845196723938 ROC AUC: 1.0
Validation loss: 0.20379187166690826 ROC AUC: 1.0
Validation loss: 0.1986018866300583 ROC AUC: 1.0
Validation loss: 0.2047867625951767 ROC AUC: 1.0
50 0 0.2524549067020416
Validation loss: 0.20249846577644348 ROC AUC: 1.0
Validation loss: 0.22275058925151825 ROC AUC: 1.0
Validation loss: 0.22554384171962738 ROC AUC: 1.0
Validation loss: 0.226180762052536 ROC AUC: 1.0
Validation loss: 0.21452561020851135 ROC AUC: 1.0
Validation loss: 0.18746045231819153 ROC AUC: 1.0
Validation loss: 0.15794028341770172 ROC AUC: 1.0
Validation loss: 0.134937584400177 ROC AUC: 1.0
Validation loss: 0.12738564610481262 ROC AUC: 1.0
Validation loss: 0.11149757355451584 ROC AUC: 1.0
Validation loss: 0.09676510095596313 ROC AUC: 1.0
Validation loss: 0.08944270759820938 ROC AUC: 1.0
Validation loss: 0.08268314599990845 ROC AUC: 1.0
Validation loss: 0.0745682418346405 ROC AUC: 1.0
Validation loss: 0.06947996467351913 ROC AUC: 1.0
Validation loss: 0.062382154166698456 ROC AUC: 1.0
Validation loss: 0.06017844378948212 ROC AUC: 1.0
Validation loss: 0.05983442813158035 ROC AUC: 1.0
Validation loss: 0.06190570071339607 ROC AUC: 1.0
Validation loss: 0.07196012139320374 ROC AUC: 1.0
Validation loss: 0.07497513294219971 ROC AUC: 1.0
Validation loss: 0.0726928859949112 ROC AUC: 1.0
Validation loss: 0.07578893005847931 ROC AUC: 1.0
Validation loss: 0.0869050845503807 ROC AUC: 1.0
Validation loss: 0.10596480220556259 ROC AUC: 1.0
Validation loss: 0.14317987859249115 ROC AUC: 1.0
Validation loss: 0.17076043784618378 ROC AUC: 1.0
Validation loss: 0.17192596197128296 ROC AUC: 1.0
Validation loss: 0.2148151993751526 ROC AUC: 1.0
Validation loss: 0.2570052742958069 ROC AUC: 1.0
Validation loss: 0.2854938805103302 ROC AUC: 1.0
Validation loss: 0.3206360638141632 ROC AUC: 1.0
Validation loss: 0.28871405124664307 ROC AUC: 1.0
Validation loss: 0.30651795864105225 ROC AUC: 1.0
Validation loss: 0.2755047380924225 ROC AUC: 1.0
Validation loss: 0.2932106852531433 ROC AUC: 1.0
Validation loss: 0.2761726379394531 ROC AUC: 1.0
Validation loss: 0.23625458776950836 ROC AUC: 1.0
Validation loss: 0.24298392236232758 ROC AUC: 1.0
Validation loss: 0.28642934560775757 ROC AUC: 1.0
Validation loss: 0.30476775765419006 ROC AUC: 1.0
Validation loss: 0.3081676661968231 ROC AUC: 1.0
Validation loss: 0.2732064127922058 ROC AUC: 1.0
Validation loss: 0.24618321657180786 ROC AUC: 1.0
Validation loss: 0.21194899082183838 ROC AUC: 1.0
Validation loss: 0.18102987110614777 ROC AUC: 1.0
Validation loss: 0.1687106490135193 ROC AUC: 1.0
Validation loss: 0.16128624975681305 ROC AUC: 1.0
Validation loss: 0.17451348900794983 ROC AUC: 1.0
Validation loss: 0.20314036309719086 ROC AUC: 1.0
Loaded trained model with success.
Test loss: 0.6708211610191747 Test ROC AUC: 0.6564127423822714
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'photoswitch_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.9503722084367245, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/photoswitch/photoswitch.csv', 'regression_bin_classes': 2}}
Running on: cpu
389
No validation set, using training set for validation
Train size: 19, Valid size: 19, Test size: 370
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.7038406729698181
Validation loss: 0.7268760204315186 ROC AUC: 0.5333333333333333
Validation loss: 0.7051340937614441 ROC AUC: 0.8555555555555556
Validation loss: 0.6913101077079773 ROC AUC: 0.7333333333333333
Validation loss: 0.7062569260597229 ROC AUC: 0.2666666666666667
Validation loss: 0.7345567345619202 ROC AUC: 0.2555555555555556
Validation loss: 0.754446804523468 ROC AUC: 0.24444444444444446
Validation loss: 0.7750424742698669 ROC AUC: 0.2777777777777778
Validation loss: 0.7969381809234619 ROC AUC: 0.33333333333333337
Validation loss: 0.7816449999809265 ROC AUC: 0.4666666666666667
Validation loss: 0.756027340888977 ROC AUC: 0.5555555555555556
Validation loss: 0.7368131279945374 ROC AUC: 0.6333333333333333
Validation loss: 0.7337561249732971 ROC AUC: 0.6777777777777778
Validation loss: 0.7289915084838867 ROC AUC: 0.7333333333333334
Validation loss: 0.7342851758003235 ROC AUC: 0.7333333333333334
Validation loss: 0.7374799251556396 ROC AUC: 0.7222222222222223
Validation loss: 0.7453138828277588 ROC AUC: 0.6222222222222222
Validation loss: 0.7558018565177917 ROC AUC: 0.5777777777777777
Validation loss: 0.7764413952827454 ROC AUC: 0.5
Validation loss: 0.8007375001907349 ROC AUC: 0.45555555555555555
Validation loss: 0.7890502214431763 ROC AUC: 0.4777777777777778
Validation loss: 0.7567710876464844 ROC AUC: 0.5555555555555556
Validation loss: 0.7244917750358582 ROC AUC: 0.6000000000000001
Validation loss: 0.6931183934211731 ROC AUC: 0.6333333333333333
Validation loss: 0.6803805828094482 ROC AUC: 0.6333333333333333
Validation loss: 0.65851229429245 ROC AUC: 0.6444444444444444
Validation loss: 0.633389949798584 ROC AUC: 0.6888888888888889
Validation loss: 0.6038137674331665 ROC AUC: 0.7555555555555555
Validation loss: 0.5677348971366882 ROC AUC: 0.8222222222222222
Validation loss: 0.5445640683174133 ROC AUC: 0.8555555555555556
Validation loss: 0.5208120942115784 ROC AUC: 0.8666666666666667
Validation loss: 0.5022986531257629 ROC AUC: 0.9
Validation loss: 0.4972008764743805 ROC AUC: 0.9333333333333333
Validation loss: 0.5125578045845032 ROC AUC: 0.9555555555555555
Validation loss: 0.514523446559906 ROC AUC: 0.9666666666666667
Validation loss: 0.5013863444328308 ROC AUC: 0.9666666666666667
Validation loss: 0.4898848235607147 ROC AUC: 0.9666666666666667
Validation loss: 0.49377039074897766 ROC AUC: 0.9666666666666667
Validation loss: 0.487631231546402 ROC AUC: 0.9666666666666667
Validation loss: 0.4855876863002777 ROC AUC: 0.9555555555555556
Validation loss: 0.4839131236076355 ROC AUC: 0.9333333333333333
Validation loss: 0.46548521518707275 ROC AUC: 0.9333333333333333
Validation loss: 0.4728093445301056 ROC AUC: 0.9555555555555556
Validation loss: 0.49480414390563965 ROC AUC: 0.9555555555555556
Validation loss: 0.5155808329582214 ROC AUC: 0.9666666666666667
Validation loss: 0.5242769718170166 ROC AUC: 0.9888888888888888
Validation loss: 0.5119865536689758 ROC AUC: 0.9888888888888888
Validation loss: 0.4987696707248688 ROC AUC: 0.9888888888888888
Validation loss: 0.47160008549690247 ROC AUC: 0.9888888888888888
Validation loss: 0.4408884644508362 ROC AUC: 0.9888888888888888
Validation loss: 0.43622252345085144 ROC AUC: 1.0
50 0 0.6635584235191345
Validation loss: 0.4447444677352905 ROC AUC: 1.0
Validation loss: 0.4138467609882355 ROC AUC: 1.0
Validation loss: 0.3447563946247101 ROC AUC: 1.0
Validation loss: 0.2878243625164032 ROC AUC: 1.0
Validation loss: 0.21248792111873627 ROC AUC: 1.0
Validation loss: 0.1558961272239685 ROC AUC: 1.0
Validation loss: 0.13922543823719025 ROC AUC: 1.0
Validation loss: 0.1316881775856018 ROC AUC: 1.0
Validation loss: 0.13437166810035706 ROC AUC: 1.0
Validation loss: 0.1447771042585373 ROC AUC: 1.0
Validation loss: 0.15823020040988922 ROC AUC: 1.0
Validation loss: 0.17056019604206085 ROC AUC: 1.0
Validation loss: 0.18628595769405365 ROC AUC: 1.0
Validation loss: 0.2016516774892807 ROC AUC: 1.0
Validation loss: 0.21209368109703064 ROC AUC: 1.0
Validation loss: 0.21615153551101685 ROC AUC: 1.0
Validation loss: 0.21415497362613678 ROC AUC: 1.0
Validation loss: 0.20343205332756042 ROC AUC: 1.0
Validation loss: 0.1914028823375702 ROC AUC: 1.0
Validation loss: 0.18077130615711212 ROC AUC: 1.0
Validation loss: 0.16107335686683655 ROC AUC: 1.0
Validation loss: 0.14977006614208221 ROC AUC: 1.0
Validation loss: 0.14057379961013794 ROC AUC: 1.0
Validation loss: 0.13625985383987427 ROC AUC: 1.0
Validation loss: 0.12867605686187744 ROC AUC: 1.0
Validation loss: 0.1261463165283203 ROC AUC: 1.0
Validation loss: 0.12384935468435287 ROC AUC: 1.0
Validation loss: 0.11705049872398376 ROC AUC: 1.0
Validation loss: 0.11961199343204498 ROC AUC: 1.0
Validation loss: 0.11975328624248505 ROC AUC: 1.0
Validation loss: 0.1113361045718193 ROC AUC: 1.0
Validation loss: 0.10452738404273987 ROC AUC: 1.0
Validation loss: 0.09521374106407166 ROC AUC: 1.0
Validation loss: 0.09270273894071579 ROC AUC: 1.0
Validation loss: 0.08434556424617767 ROC AUC: 1.0
Validation loss: 0.07391355186700821 ROC AUC: 1.0
Validation loss: 0.06955189257860184 ROC AUC: 1.0
Validation loss: 0.06771717220544815 ROC AUC: 1.0
Validation loss: 0.05119745433330536 ROC AUC: 1.0
Validation loss: 0.05347523093223572 ROC AUC: 1.0
Validation loss: 0.051253627985715866 ROC AUC: 1.0
Validation loss: 0.04776967316865921 ROC AUC: 1.0
Validation loss: 0.049619320780038834 ROC AUC: 1.0
Validation loss: 0.04882959648966789 ROC AUC: 1.0
Validation loss: 0.0570029653608799 ROC AUC: 1.0
Validation loss: 0.06598609685897827 ROC AUC: 1.0
Validation loss: 0.07514069974422455 ROC AUC: 1.0
Validation loss: 0.0808524563908577 ROC AUC: 1.0
Validation loss: 0.08216836303472519 ROC AUC: 1.0
Validation loss: 0.08710690587759018 ROC AUC: 1.0
Loaded trained model with success.
Test loss: 0.5352432031889219 Test ROC AUC: 0.9126807888970052
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'photoswitch_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.8759305210918115, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/photoswitch/photoswitch.csv', 'regression_bin_classes': 2}}
Running on: cpu
389
No validation set, using training set for validation
Train size: 48, Valid size: 48, Test size: 341
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.6875048875808716
Validation loss: 0.7901047666867574 ROC AUC: 0.3993055555555556
Validation loss: 0.8662751515706381 ROC AUC: 0.3697916666666667
Validation loss: 0.7268445690472921 ROC AUC: 0.3645833333333333
Validation loss: 0.6933467785517374 ROC AUC: 0.6371527777777779
Validation loss: 0.6954554120699564 ROC AUC: 0.7100694444444444
Validation loss: 0.6844802498817444 ROC AUC: 0.6822916666666666
Validation loss: 0.7042718132336935 ROC AUC: 0.6493055555555556
Validation loss: 0.7645347515741984 ROC AUC: 0.673611111111111
Validation loss: 0.8540748556454977 ROC AUC: 0.7100694444444445
Validation loss: 0.8850106000900269 ROC AUC: 0.8072916666666666
Validation loss: 0.8206990162531534 ROC AUC: 0.8454861111111113
Validation loss: 0.7052704493204752 ROC AUC: 0.8593749999999999
Validation loss: 0.5811696251233419 ROC AUC: 0.8819444444444444
Validation loss: 0.4757575988769531 ROC AUC: 0.8958333333333333
Validation loss: 0.40896763404210407 ROC AUC: 0.9114583333333333
Validation loss: 0.3951928913593292 ROC AUC: 0.9114583333333334
Validation loss: 0.3876062035560608 ROC AUC: 0.9149305555555556
Validation loss: 0.3901658356189728 ROC AUC: 0.9166666666666666
Validation loss: 0.39292945464452106 ROC AUC: 0.9184027777777778
Validation loss: 0.41433929403622943 ROC AUC: 0.9218749999999999
Validation loss: 0.4533909360567729 ROC AUC: 0.9201388888888888
Validation loss: 0.48629329601923627 ROC AUC: 0.9184027777777777
Validation loss: 0.540383110443751 ROC AUC: 0.920138888888889
Validation loss: 0.6174501379330953 ROC AUC: 0.9131944444444445
Validation loss: 0.6554085512955984 ROC AUC: 0.907986111111111
25 0 0.4807220697402954
Validation loss: 0.7175947030385336 ROC AUC: 0.907986111111111
Validation loss: 0.7757479945818583 ROC AUC: 0.9097222222222222
Validation loss: 0.836425264676412 ROC AUC: 0.9114583333333334
Validation loss: 0.8076448639233907 ROC AUC: 0.9184027777777778
Validation loss: 0.8256094853083292 ROC AUC: 0.9253472222222222
Validation loss: 0.7758232355117798 ROC AUC: 0.9305555555555555
Validation loss: 0.6446883877118429 ROC AUC: 0.939236111111111
Validation loss: 0.5934744477272034 ROC AUC: 0.9409722222222222
Validation loss: 0.5626266201337179 ROC AUC: 0.9461805555555556
Validation loss: 0.4825059771537781 ROC AUC: 0.9513888888888888
Validation loss: 0.44311551253000897 ROC AUC: 0.9513888888888888
Validation loss: 0.4262598156929016 ROC AUC: 0.9479166666666665
Validation loss: 0.4620547691980998 ROC AUC: 0.9444444444444444
Validation loss: 0.48044190804163617 ROC AUC: 0.9444444444444444
Validation loss: 0.5062705675760905 ROC AUC: 0.9427083333333334
Validation loss: 0.5197870433330536 ROC AUC: 0.9427083333333334
Validation loss: 0.49794551730155945 ROC AUC: 0.9427083333333334
Validation loss: 0.491441011428833 ROC AUC: 0.9444444444444444
Validation loss: 0.5384113391240438 ROC AUC: 0.9479166666666665
Validation loss: 0.5149954458077749 ROC AUC: 0.9479166666666666
Validation loss: 0.49960410594940186 ROC AUC: 0.9496527777777778
Validation loss: 0.5467822700738907 ROC AUC: 0.953125
Validation loss: 0.5676916837692261 ROC AUC: 0.953125
Validation loss: 0.5937285621960958 ROC AUC: 0.954861111111111
Validation loss: 0.5187004705270132 ROC AUC: 0.9583333333333333
50 0 0.40890172123908997
Validation loss: 0.5397486885388693 ROC AUC: 0.9583333333333333
Validation loss: 0.5467849870522817 ROC AUC: 0.9600694444444444
Validation loss: 0.4712851047515869 ROC AUC: 0.9583333333333333
Validation loss: 0.42356346050898236 ROC AUC: 0.9583333333333333
Validation loss: 0.3691022793451945 ROC AUC: 0.9583333333333333
Validation loss: 0.3535972634951274 ROC AUC: 0.9565972222222222
Validation loss: 0.3306983759005864 ROC AUC: 0.9565972222222222
Validation loss: 0.32868193586667377 ROC AUC: 0.9565972222222222
Validation loss: 0.32752494017283124 ROC AUC: 0.9565972222222222
Validation loss: 0.3067709406216939 ROC AUC: 0.9565972222222222
Validation loss: 0.29678327838579815 ROC AUC: 0.9565972222222222
Validation loss: 0.293719877799352 ROC AUC: 0.9565972222222222
Validation loss: 0.3117377658685048 ROC AUC: 0.9565972222222222
Validation loss: 0.3221360594034195 ROC AUC: 0.9600694444444444
Validation loss: 0.33729907870292664 ROC AUC: 0.9635416666666667
Validation loss: 0.3585892717043559 ROC AUC: 0.9670138888888888
Validation loss: 0.3542851706345876 ROC AUC: 0.96875
Validation loss: 0.34030041098594666 ROC AUC: 0.9687499999999999
Validation loss: 0.35048284629980725 ROC AUC: 0.9687499999999999
Validation loss: 0.3169126808643341 ROC AUC: 0.970486111111111
Validation loss: 0.3135601580142975 ROC AUC: 0.9722222222222222
Validation loss: 0.30241408944129944 ROC AUC: 0.9774305555555556
Validation loss: 0.2868407666683197 ROC AUC: 0.9809027777777777
Validation loss: 0.2767200867335002 ROC AUC: 0.9791666666666666
Validation loss: 0.27700430154800415 ROC AUC: 0.9809027777777777
75 0 0.1710280030965805
Validation loss: 0.2682034025589625 ROC AUC: 0.984375
Validation loss: 0.2671514302492142 ROC AUC: 0.9878472222222223
Validation loss: 0.24830156564712524 ROC AUC: 0.9895833333333334
Validation loss: 0.24756103257338205 ROC AUC: 0.9895833333333334
Validation loss: 0.2436836063861847 ROC AUC: 0.9895833333333334
Validation loss: 0.2135988473892212 ROC AUC: 0.9913194444444444
Validation loss: 0.20774829387664795 ROC AUC: 0.9895833333333333
Validation loss: 0.203953484694163 ROC AUC: 0.9895833333333333
Validation loss: 0.17692248771588007 ROC AUC: 0.9913194444444444
Validation loss: 0.15458475425839424 ROC AUC: 0.9913194444444444
Validation loss: 0.14321143428484598 ROC AUC: 0.9930555555555555
Validation loss: 0.13478793452183405 ROC AUC: 0.9930555555555555
Validation loss: 0.12028307716051738 ROC AUC: 0.9947916666666666
Validation loss: 0.11344718436400096 ROC AUC: 0.9947916666666666
Validation loss: 0.10881583206355572 ROC AUC: 0.9947916666666666
Validation loss: 0.11694806938370068 ROC AUC: 0.998263888888889
Validation loss: 0.14151666313409805 ROC AUC: 0.998263888888889
Validation loss: 0.18173200885454813 ROC AUC: 0.998263888888889
Validation loss: 0.19191407163937887 ROC AUC: 0.9965277777777778
Validation loss: 0.16635418931643167 ROC AUC: 0.9965277777777778
Validation loss: 0.13292594254016876 ROC AUC: 0.9965277777777778
Validation loss: 0.10685400292277336 ROC AUC: 0.998263888888889
Validation loss: 0.09227517743905385 ROC AUC: 0.998263888888889
Validation loss: 0.08064131687084834 ROC AUC: 0.998263888888889
Validation loss: 0.08135705441236496 ROC AUC: 0.998263888888889
Loaded trained model with success.
Test loss: 0.3351274715665498 Test ROC AUC: 0.9519435844513243
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'photoswitch_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.7518610421836228, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/photoswitch/photoswitch.csv', 'regression_bin_classes': 2}}
Running on: cpu
389
No validation set, using training set for validation
Train size: 96, Valid size: 96, Test size: 293
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.6932195425033569
Validation loss: 0.7063260674476624 ROC AUC: 0.29904513888888884
Validation loss: 0.6989141305287679 ROC AUC: 0.3198784722222222
Validation loss: 0.7464628020922343 ROC AUC: 0.2838541666666667
Validation loss: 0.9265882968902588 ROC AUC: 0.2994791666666667
Validation loss: 0.8986419240633646 ROC AUC: 0.3233506944444445
Validation loss: 0.7537294824918112 ROC AUC: 0.34244791666666663
Validation loss: 0.722943107287089 ROC AUC: 0.4305555555555555
Validation loss: 0.6844398975372314 ROC AUC: 0.6111111111111112
Validation loss: 0.6639180978139242 ROC AUC: 0.6922743055555557
Validation loss: 0.6637923717498779 ROC AUC: 0.6223958333333334
Validation loss: 0.672737717628479 ROC AUC: 0.6232638888888888
Validation loss: 0.7146377960840861 ROC AUC: 0.5486111111111112
Validation loss: 0.7438140114148458 ROC AUC: 0.53515625
Validation loss: 0.741054634253184 ROC AUC: 0.52734375
Validation loss: 0.7143760720888773 ROC AUC: 0.5490451388888888
Validation loss: 0.6812149882316589 ROC AUC: 0.59765625
16 2 0.6205640435218811
Validation loss: 0.7028356989224752 ROC AUC: 0.578125
Validation loss: 0.6891553203264872 ROC AUC: 0.6167534722222222
Validation loss: 0.6627152959505717 ROC AUC: 0.671875
Validation loss: 0.6134921113650004 ROC AUC: 0.7430555555555556
Validation loss: 0.5985890825589498 ROC AUC: 0.775607638888889
Validation loss: 0.6019954284032186 ROC AUC: 0.7643229166666666
Validation loss: 0.6318039496739706 ROC AUC: 0.7413194444444445
Validation loss: 0.6418147087097168 ROC AUC: 0.7491319444444444
Validation loss: 0.5843847990036011 ROC AUC: 0.787326388888889
Validation loss: 0.4583484133084615 ROC AUC: 0.8684895833333334
Validation loss: 0.4602699975172679 ROC AUC: 0.8875868055555556
Validation loss: 0.3494427601496379 ROC AUC: 0.9461805555555556
Validation loss: 0.27547304332256317 ROC AUC: 0.9657118055555556
Validation loss: 0.24681159357229868 ROC AUC: 0.9674479166666667
Validation loss: 0.23018928865591684 ROC AUC: 0.9709201388888888
Validation loss: 0.2356768250465393 ROC AUC: 0.9713541666666666
Validation loss: 0.24154398838678995 ROC AUC: 0.9713541666666666
33 1 0.3063594698905945
Validation loss: 0.27694206436475116 ROC AUC: 0.9704861111111112
Validation loss: 0.2572465439637502 ROC AUC: 0.9774305555555556
Validation loss: 0.21175822367270788 ROC AUC: 0.984375
Validation loss: 0.16594495375951132 ROC AUC: 0.9869791666666667
Validation loss: 0.16562520960966745 ROC AUC: 0.9865451388888888
Validation loss: 0.16958405077457428 ROC AUC: 0.9874131944444444
Validation loss: 0.14287464072306952 ROC AUC: 0.9887152777777778
Validation loss: 0.13199947029352188 ROC AUC: 0.9900173611111112
Validation loss: 0.13896536330382028 ROC AUC: 0.9891493055555556
Validation loss: 0.24073857069015503 ROC AUC: 0.9865451388888888
Validation loss: 0.2866668899854024 ROC AUC: 0.9861111111111112
Validation loss: 0.1654645800590515 ROC AUC: 0.9891493055555556
Validation loss: 0.13156887019673982 ROC AUC: 0.9934895833333334
Validation loss: 0.1391069566210111 ROC AUC: 0.9952256944444444
Validation loss: 0.16379987200101218 ROC AUC: 0.9952256944444444
Validation loss: 0.2477524926265081 ROC AUC: 0.9934895833333333
Validation loss: 0.23434147735436758 ROC AUC: 0.9947916666666666
50 0 0.2821909189224243
Validation loss: 0.1914956085383892 ROC AUC: 0.9969618055555556
Validation loss: 0.11437449604272842 ROC AUC: 0.9978298611111112
Validation loss: 0.10915854138632615 ROC AUC: 0.9986979166666666
Validation loss: 0.0923412994792064 ROC AUC: 0.9986979166666666
Validation loss: 0.09931648708879948 ROC AUC: 0.998263888888889
Validation loss: 0.10029479674994946 ROC AUC: 0.9986979166666666
Validation loss: 0.06679967542489369 ROC AUC: 1.0
Validation loss: 0.05478624006112417 ROC AUC: 1.0
Validation loss: 0.07932091442247231 ROC AUC: 0.9991319444444444
Validation loss: 0.11540222788850467 ROC AUC: 0.9991319444444444
Validation loss: 0.10696496938665707 ROC AUC: 0.9991319444444444
Validation loss: 0.06536849091450374 ROC AUC: 0.9995659722222222
Validation loss: 0.06704726939400037 ROC AUC: 1.0
Validation loss: 0.11162257799878716 ROC AUC: 0.9991319444444444
Validation loss: 0.12076397395382325 ROC AUC: 0.9982638888888888
Validation loss: 0.16087713713447252 ROC AUC: 0.9978298611111112
66 2 0.11816081404685974
Validation loss: 0.179608516395092 ROC AUC: 0.9978298611111112
Validation loss: 0.1380715345342954 ROC AUC: 0.9995659722222222
Validation loss: 0.09939672177036603 ROC AUC: 1.0
Validation loss: 0.17623339034616947 ROC AUC: 1.0
Validation loss: 0.18689395735661188 ROC AUC: 1.0
Validation loss: 0.10280893618861835 ROC AUC: 1.0
Validation loss: 0.04501291053990523 ROC AUC: 1.0
Validation loss: 0.036516641887525715 ROC AUC: 1.0
Validation loss: 0.061948346284528576 ROC AUC: 1.0
Validation loss: 0.10362621769309044 ROC AUC: 1.0
Validation loss: 0.08306512919565041 ROC AUC: 1.0
Validation loss: 0.035724813623043396 ROC AUC: 1.0
Validation loss: 0.009959554377322396 ROC AUC: 1.0
Validation loss: 0.005587384424870834 ROC AUC: 1.0
Validation loss: 0.04598518585165342 ROC AUC: 1.0
Validation loss: 0.1168451967338721 ROC AUC: 1.0
Validation loss: 0.07457667247702678 ROC AUC: 1.0
83 1 0.04744671657681465
Validation loss: 0.024721504499514897 ROC AUC: 1.0
Validation loss: 0.015192914754152298 ROC AUC: 1.0
Validation loss: 0.015430275040368239 ROC AUC: 1.0
Validation loss: 0.026624041919906933 ROC AUC: 1.0
Validation loss: 0.022172298282384872 ROC AUC: 1.0
Validation loss: 0.020212352896730106 ROC AUC: 1.0
Validation loss: 0.015171695423002044 ROC AUC: 1.0
Validation loss: 0.005623967852443457 ROC AUC: 1.0
Validation loss: 0.003561506358285745 ROC AUC: 1.0
Validation loss: 0.004549004273333897 ROC AUC: 1.0
Validation loss: 0.007514118333347142 ROC AUC: 1.0
Validation loss: 0.014105661772191525 ROC AUC: 1.0
Validation loss: 0.01663882192224264 ROC AUC: 1.0
Validation loss: 0.014130005583865568 ROC AUC: 1.0
Validation loss: 0.005793631697694461 ROC AUC: 1.0
Validation loss: 0.0022558286339820675 ROC AUC: 1.0
Validation loss: 0.001503373806675275 ROC AUC: 1.0
Loaded trained model with success.
Test loss: 0.35229023039951257 Test ROC AUC: 0.9532196440219922
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'photoswitch_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.5037220843672456, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/photoswitch/photoswitch.csv', 'regression_bin_classes': 2}}
Running on: cpu
389
No validation set, using training set for validation
Train size: 193, Valid size: 193, Test size: 196
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.750055193901062
Validation loss: 0.7091089876204575 ROC AUC: 0.8087951030927835
Validation loss: 0.6974403209636866 ROC AUC: 0.7511275773195876
Validation loss: 0.671439693999414 ROC AUC: 0.6443298969072164
Validation loss: 0.7328128212474171 ROC AUC: 0.656786941580756
Validation loss: 0.6649916051582969 ROC AUC: 0.6607603092783504
Validation loss: 0.6166128034418729 ROC AUC: 0.7239046391752577
Validation loss: 0.6413048586079494 ROC AUC: 0.7895725945017182
7 1 0.6170446872711182
Validation loss: 0.5196363682728358 ROC AUC: 0.8548646907216495
Validation loss: 0.4291317969406207 ROC AUC: 0.9050687285223368
Validation loss: 0.3896483185995428 ROC AUC: 0.9269222508591065
Validation loss: 0.38017059221786537 ROC AUC: 0.9294995704467354
Validation loss: 0.32922358258863804 ROC AUC: 0.9335803264604811
Validation loss: 0.41124736996357925 ROC AUC: 0.9455004295532645
Validation loss: 0.35779535214518016 ROC AUC: 0.9564540378006873
14 2 0.20251861214637756
Validation loss: 0.27518909783560996 ROC AUC: 0.9656894329896907
Validation loss: 0.2808252478819437 ROC AUC: 0.97009235395189
Validation loss: 0.32974593287304893 ROC AUC: 0.9736898625429553
Validation loss: 0.24909397774409753 ROC AUC: 0.9756765463917526
Validation loss: 0.20543625559947343 ROC AUC: 0.9742804982817869
Validation loss: 0.19858735126148852 ROC AUC: 0.9771799828178694
Validation loss: 0.27226003895904577 ROC AUC: 0.9787908075601375
21 3 0.5825643539428711
Validation loss: 0.4543618674105313 ROC AUC: 0.9785760309278351
Validation loss: 0.4672765416211396 ROC AUC: 0.9806701030927834
Validation loss: 0.29961859407820235 ROC AUC: 0.9802942439862543
Validation loss: 0.1850190027158495 ROC AUC: 0.9788981958762887
Validation loss: 0.17663227569871615 ROC AUC: 0.9809385738831614
Validation loss: 0.28871853765428374 ROC AUC: 0.9819050687285222
Validation loss: 0.5013193207083588 ROC AUC: 0.9828715635738832
28 4 0.37592464685440063
Validation loss: 0.2920290064935239 ROC AUC: 0.9834085051546393
Validation loss: 0.21936635823601885 ROC AUC: 0.983838058419244
Validation loss: 0.17680569444758903 ROC AUC: 0.9855562714776632
Validation loss: 0.19092872970462463 ROC AUC: 0.9862006013745706
Validation loss: 0.1668945339778583 ROC AUC: 0.9874355670103093
Validation loss: 0.2580955107865247 ROC AUC: 0.9863079896907216
Validation loss: 0.2892817005592307 ROC AUC: 0.9862542955326461
35 5 0.2474854290485382
Validation loss: 0.2910526730699243 ROC AUC: 0.9849119415807561
Validation loss: 0.15910828715779002 ROC AUC: 0.9852341065292096
Validation loss: 0.1922065174023722 ROC AUC: 0.9856636597938144
Validation loss: 0.15417311038976353 ROC AUC: 0.9879188144329896
Validation loss: 0.2562602461455782 ROC AUC: 0.9868986254295532
Validation loss: 0.31189243122935295 ROC AUC: 0.9860932130584192
Validation loss: 0.18854542407278066 ROC AUC: 0.9858784364261169
42 6 0.7188097834587097
Validation loss: 0.20943861763557622 ROC AUC: 0.985448883161512
Validation loss: 0.18071503033909772 ROC AUC: 0.9837843642611684
Validation loss: 0.1726907065495308 ROC AUC: 0.9841602233676976
Validation loss: 0.14707846592107088 ROC AUC: 0.9854488831615121
Validation loss: 0.16817973094746239 ROC AUC: 0.9876503436426117
Validation loss: 0.22448851988491617 ROC AUC: 0.9879188144329897
Validation loss: 0.16557315632778127 ROC AUC: 0.987489261168385
Validation loss: 0.16018140130710107 ROC AUC: 0.9878114261168385
50 0 0.35581153631210327
Validation loss: 0.15549622437677835 ROC AUC: 0.9887242268041236
Validation loss: 0.20986550229895917 ROC AUC: 0.9885631443298969
Validation loss: 0.14256380829740548 ROC AUC: 0.9882409793814433
Validation loss: 0.1755468137562275 ROC AUC: 0.9892074742268041
Validation loss: 0.1272773621893377 ROC AUC: 0.9891000859106529
Validation loss: 0.15578344510361136 ROC AUC: 0.9894222508591065
Validation loss: 0.14044434503878955 ROC AUC: 0.9896907216494846
57 1 0.11871526390314102
Validation loss: 0.15888209418765237 ROC AUC: 0.9899591924398625
Validation loss: 0.16148604422480767 ROC AUC: 0.9889390034364262
Validation loss: 0.18686184683727786 ROC AUC: 0.9882409793814433
Validation loss: 0.19400753721672018 ROC AUC: 0.9894222508591065
Validation loss: 0.15345943733504516 ROC AUC: 0.9901739690721649
Validation loss: 0.13638431149163316 ROC AUC: 0.9906035223367697
Validation loss: 0.15466869617093035 ROC AUC: 0.9911404639175257
64 2 0.27176815271377563
Validation loss: 0.19523628233627952 ROC AUC: 0.9907646048109966
Validation loss: 0.16561144974337252 ROC AUC: 0.9904961340206185
Validation loss: 0.1495734710593761 ROC AUC: 0.9896370274914089
Validation loss: 0.1581774809605254 ROC AUC: 0.9906572164948453
Validation loss: 0.12302401547025832 ROC AUC: 0.9904961340206185
Validation loss: 0.12989722405333515 ROC AUC: 0.9911404639175257
Validation loss: 0.16716067099200627 ROC AUC: 0.9913552405498282
71 3 0.20596593618392944
Validation loss: 0.15566110487274404 ROC AUC: 0.991247852233677
Validation loss: 0.13536276903794836 ROC AUC: 0.9925365120274915
Validation loss: 0.12472322258924573 ROC AUC: 0.9931808419243986
Validation loss: 0.11147973667154658 ROC AUC: 0.9940399484536082
Validation loss: 0.12326675960359795 ROC AUC: 0.9926439003436427
Validation loss: 0.1258462325240355 ROC AUC: 0.9916774054982819
Validation loss: 0.12362831742309728 ROC AUC: 0.991784793814433
78 4 0.15069358050823212
Validation loss: 0.14088527562936354 ROC AUC: 0.9940936426116838
Validation loss: 0.15665459991167324 ROC AUC: 0.994469501718213
Validation loss: 0.11512466541635008 ROC AUC: 0.9944158075601375
Validation loss: 0.12217501354997332 ROC AUC: 0.9941473367697594
Validation loss: 0.15739203942215813 ROC AUC: 0.9937177835051546
Validation loss: 0.11061021145119623 ROC AUC: 0.9931808419243987
Validation loss: 0.11425984540708131 ROC AUC: 0.9927512886597938
85 5 0.21532727777957916
Validation loss: 0.15860825467814324 ROC AUC: 0.9923754295532645
Validation loss: 0.12031594649381896 ROC AUC: 0.9930734536082474
Validation loss: 0.13956129800895026 ROC AUC: 0.9941473367697595
Validation loss: 0.12901143019492955 ROC AUC: 0.9933956185567011
Validation loss: 0.11873559840174315 ROC AUC: 0.993395618556701
Validation loss: 0.11319486784550888 ROC AUC: 0.9939862542955327
Validation loss: 0.14342800091585348 ROC AUC: 0.993932560137457
92 6 0.7218513488769531
Validation loss: 0.12116662084747473 ROC AUC: 0.9932882302405498
Validation loss: 0.14078670025590825 ROC AUC: 0.9937714776632302
Validation loss: 0.1703434279622809 ROC AUC: 0.9939325601374571
Validation loss: 0.20226495006541514 ROC AUC: 0.993932560137457
Validation loss: 0.12741019625043004 ROC AUC: 0.9935567010309279
Validation loss: 0.11099571307006394 ROC AUC: 0.9932882302405498
Validation loss: 0.11949755798721742 ROC AUC: 0.9931808419243987
Validation loss: 0.15788210117755158 ROC AUC: 0.9946842783505155
Loaded trained model with success.
Test loss: 0.38051735199227626 Test ROC AUC: 0.9805289462723865
{'batch_size': 32, 'epochs': 100, 'eval_every_n_epochs': 1, 'fine_tune_from': 'pretrained_gin', 'log_every_n_steps': 50, 'fp16_precision': False, 'init_lr': 0.0005, 'init_base_lr': 0.0001, 'weight_decay': '1e-6', 'gpu': 'cuda:0', 'task_name': 'opv_2', 'model_type': 'gin', 'model': {'num_layer': 5, 'emb_dim': 300, 'feat_dim': 512, 'drop_ratio': 0.3, 'pool': 'mean', 'output_dim': 2}, 'dataset': {'num_workers': 4, 'valid_size': 0, 'test_size': 0.5446265938069217, 'splitting': 'stratified', 'task': 'classification', 'data_path': 'data/opv/opv.csv', 'regression_bin_classes': 2}}
Running on: cpu
1097
No validation set, using training set for validation
Train size: 499, Valid size: 499, Test size: 598
Model has 2207846 parameters
Loaded pre-trained model with success.
pred_head.0.weight True
pred_head.0.bias True
pred_head.2.weight True
pred_head.2.bias True
pred_head.4.weight True
pred_head.4.bias True
0 0 0.7214571237564087
Validation loss: 0.8203255003822113 ROC AUC: 0.5978313253012049
Validation loss: 0.7197218857451766 ROC AUC: 0.6121204819277108
Validation loss: 0.6771415618951908 ROC AUC: 0.627277108433735
3 2 0.7711571455001831
Validation loss: 0.7880985325945165 ROC AUC: 0.6579678714859438
Validation loss: 0.7404448435397329 ROC AUC: 0.6663212851405622
Validation loss: 0.752666269132274 ROC AUC: 0.6815983935742973
6 4 0.726001501083374
Validation loss: 0.7379191356574843 ROC AUC: 0.6898714859437751
Validation loss: 0.8704844560317382 ROC AUC: 0.7014859437751003
Validation loss: 0.6322060471068404 ROC AUC: 0.7296224899598394
9 6 0.6005554795265198
Validation loss: 0.6398004165632214 ROC AUC: 0.7450682730923694
Validation loss: 0.6289682259301623 ROC AUC: 0.7454779116465864
Validation loss: 0.5703320414843206 ROC AUC: 0.772409638554217
12 8 0.5923975706100464
Validation loss: 1.2275738642067613 ROC AUC: 0.7447951807228914
